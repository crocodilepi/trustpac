# dimension #
dimension 2

# domaine #
domaine dom

# probleme de condution de la chaleur #
Pb_conduction pb

# BEGIN MESH #
Lire_med family_names_from_group_names dom Mesh_1 Mesh_1.med
# END MESH #

# discretisation VEF #
vefprep1b dis

# time scheme #
scheme_euler_implicit scheme

Read scheme
{
    tinit 0.
    tmax 10.
    dt_min 1e-7
    dt_max 1.
    dt_impr 1.
    dt_sauv 1.
    seuil_statio 1.e-6
    facsec 1e6
    facsec_max 1e8
    Solveur Implicite
    {
      Solveur petsc cholesky { quiet }
    }
}

# physics properties of medium  #
solide sol
read sol
{
    rho champ_uniforme 1 1.0
    lambda champ_uniforme 1 1.
    Cp champ_uniforme 1 1.0
}

# associate the problem with the geometry, the time scheme and the physic properties #
associate pb dom
associate pb scheme
associate pb sol

# meshing the geometry with the given discretisation method #
discretize pb dis

# definition of the problem #
read pb
{
	# Resolution div (-grad u) = 0 donc sans source, sans coefficient, steady state #
	conduction
	{
		diffusion { }
		initial_conditions {
			temperature champ_uniforme 1 1.
		}
		boundary_conditions {
			Gauche paroi_flux_impose champ_front_uniforme 1 0.
			Droit paroi_flux_impose champ_front_uniforme 1 0.
			Haut paroi_temperature_imposee champ_front_uniforme 1 1.
			Bas paroi_temperature_imposee champ_front_uniforme 1 0.
		}
	}

	# post traitement  #
	post_processing
	{
		# define the champs for exporting the coefficient anisotrope #
		definition_champs 
		{
			# gradient of temperature grad(u) = [ux uy]^T #
			gradT gradient {
				source refchamp { Pb_champ pb temperature }
			}
		}

		format med_major fields dt_post 1.
		{
			temperature elem
			temperature som
			gradT elem
			gradT som
		}
	}
}

# solve the problem #
solve pb

end
